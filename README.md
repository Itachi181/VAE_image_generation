This is VAE_training_test branch
